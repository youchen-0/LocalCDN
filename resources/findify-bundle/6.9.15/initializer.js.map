{"version":3,"sources":["webpack:///../analytics-dom/lib/bindings/events.js","webpack:///../analytics-dom/lib/bindings/filters.js","webpack:///./src/helpers/scrollTo.ts","webpack:///./src/helpers/SignalCombinator.ts","webpack:///./src/core/events.ts","webpack:///./src/initialize.ts","webpack:///./src/helpers/addEventListeners.ts","webpack:///./src/helpers/capitalize.ts","webpack:///./src/features/create.ts","webpack:///./src/core/location.ts","webpack:///../analytics-dom/lib/helpers/decamelize.js","webpack:///./src/helpers/fallbackNode.ts","webpack:///../analytics-dom/lib/index.js","webpack:///./src/helpers/getParentNode.ts","webpack:///./src/core/emitter.ts","webpack:///./src/features/custom/index.ts","webpack:///./src/features/autocomplete/index.ts","webpack:///./src/helpers/setupPlatforms.ts","webpack:///./src/core/render.ts","webpack:///./src/core/widgets.ts","webpack:///./src/features/autocomplete/handlers.ts","webpack:///./src/helpers/documentReady.ts","webpack:///./src/helpers/findClosestElement.ts","webpack:///./src/features/recommendation/index.ts","webpack:///./src/features/content/index.ts","webpack:///./src/features/search/index.ts","webpack:///./src/features/tabs/index.ts","webpack:///./src/features/smart-collection/index.ts","webpack:///./src/features/recommendation/payload.ts","webpack:///./src/features sync ^\\.\\/.*$","webpack:///../analytics-dom/lib/bindings/dom.js","webpack:///./src/helpers/resolveCallback.ts","webpack:///./src/helpers/debounce.ts"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","__rest","e","indexOf","getOwnPropertySymbols","defineProperty","exports","value","types_1","__webpack_require__","decamelize_1","nodeToArray","node","Array","slice","normalizeKeys","obj","keys","reduce","acc","key","_a","decamelize","replace","normalizeClass","name","product_id","price_currency_code","order_number","getPropsFromChildren","nodeList","element","dataset","className","children","innerText","concat","getEventData","ownProps","EventName","purchase","updateCart","includes","event","line_items","map","childrenProps","getEventsOnPage","root","querySelectorAll","_b","rest","getDeprecatedEvents","events","pageViewNode","querySelector","purchaseNode","pageViewContent","item_id","innerHTML","line_item","data","revenue","amount","unit_price","parseFloat","getFiltersOnPage","getAttribute","type","values","isNaN","Number","Error","JSON","parse","split","v","trim","filter","r","_jump","__esModule","default","_debounce","nodes","Map","scrollTo","debounce","selector","offset","document","get","string","join","set","getBoundingClientRect","top","c","5Ihg","isArray","o","a","Symbol","iterator","next","done","push","return","TypeError","enumerable","configurable","writable","SignalCombinator","states","initialState","_defineProperty","state","transitor","transitionMapping","signalProcessor","defaultValue","signalProcessors","createSignalProcessor","signal","names","_this","signalSumName","x","processorToSignalMapping","sort","wrappedSignalProcessor","forEach","jointName","_this2","signalProcessingCache","argsToApply","signals","signalResult","apply","result","args","_this3","possibleStates","entries","_ref","_ref2","_slicedToArray","_ref3","_ref4","every","item","console","error","_len","_key","Events","_analyticsDom","_interopRequireDefault","_analytics","_emitter","_resolveCallback","_setupPlatforms","_events","_log","_scrollTo","location","_interopRequireWildcard","getOwnPropertyDescriptor","_objectSpread","asyncGeneratorStep","u","Promise","resolve","then","_asyncToGenerator","isReady","global","findify","window","listen","emitter","emit","addListeners","invalidate","isString","String","_callee","_config","asyncConfig","currency","cfg","extra","_require","fromJS","_require2","documentReady","_require3","createWidgets","bulkAddWidgets","_require4","renderWidgets","widgetsRenderNeeded","regeneratorRuntime","wrap","_callee$","_context","prev","abrupt","m","code","sent","currency_config","components","k","eval","findifyJsonp","config","analytics","platform","removeFindifyID","widgets","utils","selectors","list","test","navigator","userAgent","vendor","postMessage","__findify","store","version","mjs_version","id","merchant_id","origin","FindifyAnalytics","Analytics","stop","listeners","callback","context","withCapture","index","addEventListener","removeEventListener","capitalize","charAt","toUpperCase","camelize","FgcQ","createFeature","_react","constructor","setPrototypeOf","getPrototypeOf","__proto__","ReferenceError","l","f","FeatureCreator","props","_getPrototypeOf","_assertThisInitialized","component","mark","widget","updater","initial","setState","_component","createElement","unsubscribeForceUpdate","nextConfig","updateConfig","Component","_","_createBrowserHistory","_qs","isIE9","history","pushHistory","isAllPropsSame","collectionPath","pathname","toLowerCase","collections","getIn","listenHistory","str","search","prefix","elements","decoder","decodeURIComponent","ignoreQueryPrefix","buildQuery","_query","query","stringify","encoder","encodeURIComponent","addQueryPrefix","b","localeCompare","q","href","options","separator","fallback","style","display","visibility","showFallback","hideLoader","loaders","Mf9s","analyticsInstance","analytics_1","events_1","filters_1","dom_1","element_dataset_1","initialize","eventsConfig","filters","startDOMListeners","sendEvent","viewPage","analyticsDOM","readyState","body","__analytics","renderIn","innerWidth","parentElement","createChangeEmitter","_src","Custom","_reactConnect","_location","_handlers","_SignalCombinator","_agent","empty","createTrendingSearchesAgent","AutocompleteAgent","immutable","user","defaults","toJS","autocompleteComponent","Autocomplete","autocompleteTrendingComponent","isTrendingSearches","rerender","trendingSearchesAgent","agent","getQuery","apiKey","combinator","createSignal","trending","createSignalSum","suggestionCount","ui","noTs","transitionTo","renderTrendingSearches","AutocompleteProvider","registerHandlers","on","suggestions","meta","size","transition","_axios","disabled","shopify","persist","res","uniq_id","uid","visit_id","sid","axios","post","_reactDom","_create","_getParentNode","d","y","g","create","h","Portal","_classCallCheck","_possibleConstructorReturn","parent","getParentNode","insertBefore","firstChild","appendChild","removeChild","createPortal","RootElement","attach","toString","from","_toConsumableArray","detach","render","div","Agents","_immutable","_capitalize","cache","createAgent","instance","slot","createConfig","customs","withMutations","mergeDeep","isImmutable","_type","search-button","recommendations","isCollection","getEntity","widgetToRemove","find","findByType","types","_key2","findifyCreateFeature","propertyIsEnumerable","_objectWithoutProperties","_addEventListeners","_findClosestElement","findClosestForm","findClosestElement","container","subscribers","findifyElementFocused","setAttribute","handleWindowScroll","childNodes","_node$getBoundingClie","width","left","height","_top","scrollY","documentElement","scrollTop","_left","scrollX","scrollLeft","ghost","styles","_typeof","position","will-change","resetReferencedAgentsLogging","reset","log","updateReferencedAgents","noLogs","_value","isSearch","redirectToSearch","addEventListeners","target","relatedTarget","insideAutocomplete","hasAttribute","autocompleteFocusLost","form","preventDefault","evt","path","currentElement","tagName","unsubscribe","prop","fn","requestAnimationFrame","qgiQ","el","matchesFn","some","s5RT","_fallbackNode","_payload","getPayload","items","isEmpty","hideFallback","RecommendationProvider","Recommendation","setQuery","stopListenLocation","action","applyState","ContentProvider","Content","fallbackAgent","w","renderZeroResults","RecommendationAgent","ZeroResults","collectionNotFound","redirect","rid","suggestion","_x","_x2","SearchProvider","Search","parentNode","_createState","_widgets","counter","active","hydrate","TabsLayout","updateCount","onClick","toggle","title","count","getState","tZwI","rules","SmartCollectionProvider","v7cu","_get","_getIdsFromEvents","item_ids","multipleIds","payload","./autocomplete","./autocomplete/","./autocomplete/handlers","./autocomplete/handlers.ts","./autocomplete/index","./autocomplete/index.ts","./content","./content/","./content/index","./content/index.ts","./create","./create.ts","./custom","./custom/","./custom/index","./custom/index.ts","./recommendation","./recommendation/","./recommendation/index","./recommendation/index.ts","./recommendation/payload","./recommendation/payload.ts","./search","./search/","./search/index","./search/index.ts","./smart-collection","./smart-collection/","./smart-collection/index","./smart-collection/index.ts","./tabs","./tabs/","./tabs/index","./tabs/index.ts","webpackContext","req","webpackContextResolve","module","wNdy","proto","Element","matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","track","yyga","callbacks","findifyCallbacks","cb","promises","all","wait","timeout","ctx","clearTimeout","setTimeout"],"mappings":"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","file":"initializer.js","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\n            t[p[i]] = s[p[i]];\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar types_1 = require(\"@findify/analytics/lib/types\");\nvar decamelize_1 = require(\"../helpers/decamelize\");\nvar nodeToArray = function (node) { return Array.prototype.slice.call(node); };\nvar normalizeKeys = function (obj) {\n    if (obj === void 0) { obj = {}; }\n    return Object.keys(obj).reduce(function (acc, key) {\n        return (__assign({}, acc, (_a = {}, _a[decamelize_1.decamelize(key).replace('findify_', '')] = obj[key], _a)));\n        var _a;\n    }, {});\n};\nvar normalizeClass = function (name) {\n    return ({\n        product_id: 'item_id',\n        price_currency_code: 'currency',\n        order_number: 'order_id',\n    }[name] || name);\n};\nvar getPropsFromChildren = function (nodeList) {\n    return nodeToArray(nodeList).reduce(function (acc, element) {\n        return (__assign({}, acc, normalizeKeys(element.dataset), (!!element.className && (_a = {},\n            _a[normalizeClass(element.className)] = (!element.children.length &&\n                element.innerText) || (acc[normalizeClass(element.className)] || []).concat([\n                getPropsFromChildren(element.children),\n            ]),\n            _a))));\n        var _a;\n    }, {});\n};\nexports.getEventData = function (node) {\n    var ownProps = normalizeKeys(node.dataset);\n    if ([types_1.EventName.purchase, types_1.EventName.updateCart].includes(ownProps.event)) {\n        return __assign({}, ownProps, { line_items: nodeToArray(node.children).map(function (e) { return normalizeKeys(e.dataset); }) });\n    }\n    var childrenProps = getPropsFromChildren(node.children);\n    return __assign({}, ownProps, childrenProps);\n};\nexports.getEventsOnPage = function (root) {\n    return nodeToArray(root.querySelectorAll('[data-findify-event]'))\n        .map(exports.getEventData)\n        .reduce(function (acc, _a) {\n        var event = _a.event, rest = __rest(_a, [\"event\"]);\n        return (__assign({}, acc, (_b = {}, _b[event] = rest, _b)));\n        var _b;\n    }, {});\n};\nexports.getDeprecatedEvents = function (root) {\n    var events = {};\n    var pageViewNode = root.querySelector('.findify_page_product');\n    var purchaseNode = root.querySelector('.findify_purchase_order');\n    if (!!pageViewNode) {\n        var pageViewContent = { item_id: pageViewNode.innerHTML };\n        events['page-view'] = pageViewContent;\n        events['view-page'] = pageViewContent;\n    }\n    if (!!purchaseNode) {\n        var _a = getPropsFromChildren(purchaseNode.children), line_item = _a.line_item, data = __rest(_a, [\"line_item\"]);\n        events['purchase'] = __assign({}, data, { line_items: line_item, revenue: line_item &&\n                line_item.length &&\n                line_item.reduce(function (amount, _a) {\n                    var unit_price = _a.unit_price;\n                    return amount + parseFloat(unit_price);\n                }, 0) });\n    }\n    return events;\n};\n//# sourceMappingURL=events.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar NAME_SELECTOR = 'data-findify-filter';\nvar VALUE_SELECTOR = 'data-findify-filter-value';\nvar TYPE_SELECTOR = 'data-findify-filter-type';\nexports.getFiltersOnPage = function (root) {\n    return Array.prototype.slice\n        .call(root.querySelectorAll(\"[data-findify-filter]\"))\n        .map(function (node) {\n        var name = node.getAttribute(NAME_SELECTOR);\n        var value = node.getAttribute(VALUE_SELECTOR);\n        var type = node.getAttribute(TYPE_SELECTOR);\n        var values = void 0;\n        try {\n            if (!isNaN(Number(value)))\n                throw new Error();\n            values = JSON.parse(value);\n        }\n        catch (e) {\n            values = [{ value: value.split(/,|>/).map(function (v) { return v && v.trim(); }) }];\n        }\n        return { name: name, values: values, type: type || undefined };\n    })\n        .filter(function (i) { return !!i; });\n};\n//# sourceMappingURL=filters.js.map","import jump from 'jump.js';\nimport { debounce } from './debounce';\n\nconst nodes = new Map();\n\nconst registerNode = (string) => {\n  const node = document.querySelector(string.split(' ').map(i => '.' + i).join(''));\n  nodes.set(string, node);\n  return node;\n}\n\nexport const scrollTo: any = debounce((selector, offset = 0) => {\n  if (!document) return;\n  const node = nodes.get(selector) || registerNode(selector);\n  if (!node) return;\n  const { top } = node.getBoundingClientRect();\n  if (top > 0) return;\n  return jump(node, { offset });\n}, 200);\n","type FunctionMap = { [x: string]: Function }\ntype NullableFunctionMap = { [x: string]: Function | null }\ntype SignalSumArgument = string | Function;\n/**\n * SignalCombinator is a variation of Finite State Machine, which makes the following assumptions:\n * 1. Every state can transition to every state and itself\n * 2. State transitions are derived using a sum of signals, processed by signal processors. Each signal is a named variable,\n *    each signal processor is a function, that accepts signal value (or if it's a signal summator, values) and returns\n *    array of possible transitions\n * 3. For any combination of signals and signal-sums there is just one possible transition from one state to itself or another\n */\nexport default class SignalCombinator {\n  /** List of possible states for transitioning */\n  private states: string[];\n\n  /**\n   * Mapping of transitions to states.\n   * SignalCombinator makes an assumption, that every state can transition to every state,\n   * including itself\n   */\n  private transitionMapping: FunctionMap = {};\n\n  /**\n   * Mapping of signal processors, that receive signal (or signals) and return possible transition states to signals\n   */\n  private signalProcessors: NullableFunctionMap = {};\n\n  /**\n   * Signal values\n   */\n  private signals = {};\n\n\n  /**\n   * Used for looking up signal values, that signal processors want\n   */\n  private processorToSignalMapping = new Map<Function, string>();\n\n  /**\n   * Used for caching subsequent calls to processSignal() in one transition,\n   * mainly to avoid calling signal summator twice or more times\n   */\n  private signalProcessingCache = {};\n\n  /**\n   * Holds current state\n   */\n  public state: string;\n\n  /**\n   * Create new SignalCombinator instance\n   * @param states List of states to transition to\n   * @param initialState Initial state, if not provided first state from states array is used\n   */\n  constructor(states: string[], initialState: string) {\n    this.states = states;\n    this.state === initialState || states[0];\n  }\n\n\n  /**\n   * Used to register transition to state\n   * @param state state to transition to\n   * @param transitor function to perform transition\n   */\n  transitionTo(state: string, transitor: Function) {\n    this.transitionMapping[state] = transitor;\n  }\n\n\n  /**\n   * Used to register signal\n   * @param name signal name\n   * @param signalProcessor function, that accepts signal data and returns possible transition states\n   * @param defaultValue default value for signal\n   */\n  createSignal(name: string, signalProcessor: Function, defaultValue: any) {\n    this.signalProcessors[name] = this.createSignalProcessor(name, [name], signalProcessor);\n    this.signal(name, defaultValue);\n  }\n\n  /**\n   * Used to register override for signal processing.\n   * For example, if I have signals A, B and C and want to use not A & B & C but (A & C) & B for determining transition,\n   * then I register signal sum for signals A, C\n   * You can also pass a processor previously returned by createSignal or createSignalSum, to make things like ((A & C) & (Z & B))\n   * @param names array of signal name or processors to register sum handler for\n   * @param signalProcessor function, that accepts signal values in order they were provided in names argument and returns possible transition states\n   */\n  createSignalSum(names: SignalSumArgument[], signalProcessor: Function) {\n    /** JavaScript's sorting is not technically correct, since it sorts by ascii value, but in that case we just need a reproducible name */\n    const signalSumName = names.map(x => (\n      typeof x === 'string' ? x : ('<' + this.processorToSignalMapping.get(x)! + '>')\n    )).sort().join('|')\n    const wrappedSignalProcessor = this.createSignalProcessor(signalSumName, names, signalProcessor);\n    names.forEach((x) => typeof x === 'string' && (this.signalProcessors[x] = null));\n    this.signalProcessors[signalSumName] = wrappedSignalProcessor;\n    this.processorToSignalMapping.set(wrappedSignalProcessor, signalSumName)\n    return wrappedSignalProcessor\n  }\n\n\n  /**\n   * Used to create a signal processor, function, that handles signal caching & processing\n   * @param jointName name of signal processor. For single signals it's just signal name, for sums - sorted sum, joined by '|', i.e. x|y\n   * @param names array of signals that processor is responsible for\n   * @param signalProcessor function, that accepts signal values in order they were provided in names argument and returns possible transition states\n   * @returns object with properties: names - specifies signal arguments that were passed to createSignalProcessor,\n   * args - unwrapped arguments passed to actual signal processor\n   * result - signal processor result\n   */\n  createSignalProcessor(jointName: string, names: SignalSumArgument[], signalProcessor: Function) {\n    return () => {\n      if (this.signalProcessingCache[jointName]) return this.signalProcessingCache[jointName];\n      const argsToApply = names.map(name => typeof name === 'string' ? this.signals[name] : (<Function>name)());\n      const signalResult = signalProcessor.apply(null, argsToApply);\n      const result = { names, args: argsToApply, result: signalResult };\n      this.signalProcessingCache[jointName] = result;\n      return result;\n    }\n  }\n\n\n  /**\n   * Used to change signal values\n   * @param name signal name\n   * @param signal new signal value\n   */\n  signal(name: string, signal: any) {\n    this.signals[name] = signal;\n  }\n\n\n  /**\n   * Run transition, possibly to itself\n   * @param args any arguments provided to transition() will be provided to transition function\n   */\n  transition(...args) {\n    this.signalProcessingCache = {};\n    const possibleStates = this.states.filter(state => (\n      Object.entries(this.signalProcessors)\n        .filter(([_, v]) => v)\n        .map(([_, getSignalValue]) => getSignalValue!().result.includes(state))\n        .every(item => item))\n    );\n    if (possibleStates.length === 0) console.error('SignalCombinator Invariant: unable to form a meaningful transition from state', this.state, 'using signals', this.signals);\n    if (possibleStates.length > 1) console.error('SignalCombinator Invariant: more than 1 possible states for transitioning detected:', possibleStates, 'using signals', this.signals);\n    this.state = possibleStates[0];\n    return this.transitionMapping[this.state].apply(null, args);\n  }\n}\n","export enum Events {\n  /**\n   *  Creates new widget\n   *  @prop [selector: string] - Element where to inject widget\n   *  @prop [type: string] - Type of widget\n   *  @prop [config: object] - Config which will extend base config\n   */\n  attach = 'attachWidget',\n\n  /**\n   * Removes exist widget\n   * @prop [entity: object] - widget to remove\n  */\n  detach = 'detachWidget',\n\n  /**\n   * Will rerender component\n   * @prop [entity: object] - widget to hydrate\n  */\n  hydrate = 'hydrate',\n\n  /**\n   * Will navigate to search page with passed value as search query\n   * @prop [value: string] - search query\n  */\n  search = 'search',\n\n  /**\n   *  Will rerender widget with new config\n   * @prop [key: string|number] - widget key\n   * @prop [config: Immutable.Map] - new config\n  */\n  updateConfig = 'updateConfig',\n\n  /**\n   * Input lost focus\n   * @prop [key: string|number] - widget key\n   * @prop [config: Immutable.Map]\n   */\n  autocompleteFocusLost = 'autocompleteFocusLost',\n\n  /**\n   * Invalidate widgets\n   */\n  invalidate = 'invalidate',\n\n  /**\n   * Mobile elements\n   */\n  showMobileFacets = 'showMobileFacets',\n  showMobileSort = 'showMobileSort',\n  hideMobileFacets = 'hideMobileFacets',\n  hideMobileSort = 'hideMobileSort',\n\n  /**\n   * Calls when collection was not set up\n   */\n  collectionNotFound = 'collectionNotFound',\n}\n","import 'regenerator-runtime/runtime';\nimport 'raf/polyfill';\n\n// tslint:disable-next-line:import-name\nimport AnalyticsDOM from '@findify/analytics-dom';\n// tslint:disable-next-line:import-name\nimport Analytics from '@findify/analytics';\nimport emitter from './core/emitter';\nimport resolveCallback from './helpers/resolveCallback';\nimport setupPlatforms from './helpers/setupPlatforms';\nimport { Events } from './core/events';\nimport log from './helpers/log';\nimport { scrollTo } from './helpers/scrollTo';\nimport * as location from './core/location';\n\n/**\n * Create global namespace\n */\nconst isReady = (() => {\n  if ((global as any).findify) return false;\n  (global as any).findify = {};\n  __root.listen = emitter.listen;\n  __root.emit = emitter.emit;\n  __root.addListeners = emitter.addListeners;\n  __root.invalidate = () =>  {\n    for (const key in __webpack_require__.c) { delete __webpack_require__.c[key] }\n    emitter.emit(Events.invalidate);\n  };\n  return true;\n})();\n\nconst isString = (value) => typeof value === 'string' || value instanceof String;\n\nexport default async (\n  _config\n) => {\n  if (!isReady) return;\n\n  // We loading config independently from webpack and this promise is always resolved\n  const { default: asyncConfig } = await import(/* webpackMode: \"weak\" */'./config');\n  \n  // Fallback currency settings for versions < 6.8.2\n  const currency = asyncConfig.currency_config || asyncConfig.currency;\n\n  const cfg = {\n    ..._config,\n    ...asyncConfig,\n    currency\n  };\n\n  // Register custom components\n  if (cfg.components) {\n    const extra = Object.keys(cfg.components).reduce(\n      (acc, k) => ({\n        ...acc,\n        [k]: isString(cfg.components[k]) ? eval(cfg.components[k]) : cfg.components[k]\n      }), {}\n    )\n    __root.invalidate();\n    window.findifyJsonp.push([['extra'], extra]);\n    delete cfg.components;\n  }\n\n\n  /* Load Dependencies in closure to support polyfills */\n  const { fromJS } = require('immutable');\n  const { documentReady } = require('./helpers/documentReady');\n  const { createWidgets, bulkAddWidgets } = require('./core/widgets');\n  const { renderWidgets } = require('./core/render');\n\n  __root.config = fromJS(cfg);\n\n  /** Setup analytics */\n  __root.analytics = AnalyticsDOM({ platform: cfg.platform, key: cfg.key, events: cfg.analytics || {} });\n  if (cfg.platform) setupPlatforms(cfg.platform, cfg.removeFindifyID);\n\n  await documentReady;\n\n  const widgetsRenderNeeded = !['paused', 'disabled'].includes(__root.config.get('status'));\n\n  if (widgetsRenderNeeded) {\n    __root.widgets = createWidgets(__root.config);\n  }\n\n  /** Expose utils */\n  __root.utils = { ...location, scrollTo };\n\n  await resolveCallback(__root);\n\n  if (widgetsRenderNeeded) {\n    bulkAddWidgets(cfg.selectors);\n    renderWidgets(__root.widgets);\n    log('widgets:', '' , __root.widgets.list());\n  } else {\n    log(`findify ${__root.config.get('status')}`, 'color: #D9463F');\n  }\n\n\n  /**\n   * Notify devtools about installation\n   */\n  if (/Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor)) {\n    window.postMessage({\n      type: 'init', __findify: true, store: { version: cfg.mjs_version, id: cfg.merchant_id }\n    }, window.location.origin);\n  }\n\n  (global as any).FindifyAnalytics = Analytics;\n}\n","export const addEventListeners = (listeners, callback, context: Document | Window | HTMLElement = document, withCapture = true) => {\n  for (let index = 0; index < listeners.length; index++) {\n    context.addEventListener(listeners[index], callback, withCapture);\n  }\n  return () => {\n    for (let index = 0; index < listeners.length; index++) {\n      context.removeEventListener(listeners[index], callback, withCapture);\n    }\n  }\n}\n","export const capitalize = s => s.charAt(0).toUpperCase() + s.slice(1);\n\nexport const camelize = s => s.split('-').map(capitalize).join('');\n","import { Component, createElement } from 'react';\nimport { Events } from '../core/events';\n\nclass FeatureCreator extends Component<any>{\n  initial: any;\n  unsubscribeForceUpdate: any;\n  state = { component: null };\n\n  static displayName = 'FeatureCreator';\n\n  constructor(props) {\n    super(props);\n    const { widget, updater, key } = props;\n    this.initial = updater(widget, this.callback);\n    this.state = { component: this.initial };\n    this.unsubscribeForceUpdate = __root.listen((type, key, nextConfig) => {\n\n      // Listen to modules invalidation\n      if (type === Events.invalidate) this.invalidate();\n\n      // Listen to config change\n      if (type !== Events.updateConfig || key !== widget.key) return;\n      widget.config = nextConfig;\n      this.initial = updater(widget, this.callback);\n      this.setState({ component: this.initial });\n    });\n  }\n\n  invalidate = async () => {\n    const { widget } = this.props;\n    const updater = require(`./${widget.type}`).default;\n    this.initial = updater(widget, this.callback);\n    return this.setState({ component: this.initial });\n  }\n\n  callback = (_component, props, children) => {\n    let component;\n    if (!_component) component = null;\n    if (_component === 'initial') component = this.initial;\n    if (typeof _component === 'function') component = createElement(_component, props, children);\n    this.setState({ component });\n  }\n\n  shouldComponentUpdate(_, next) {\n    return next.component !== this.state.component;\n  }\n\n  componentWillUnmount() {\n    this.unsubscribeForceUpdate();\n  }\n\n  render() {\n    return this.state.component;\n  }\n}\n\nexport const createFeature = (widget) => {\n  const updater = require(`./${widget.type}`).default;\n  return createElement(FeatureCreator, { widget, updater })\n};\n","import 'core-js/fn/array/includes';\nimport createBrowserHistory from 'history/createBrowserHistory';\nimport { parse, stringify } from 'qs';\n\nconst isIE9 = !('pushState' in window.location);\n\nconst history = createBrowserHistory();\n\nconst pushHistory = (props) => {\n  const isAllPropsSame = Object\n    .keys(props)\n    .reduce((acc, key) => acc && props[key] === history.location[key], true);\n\n   /* Special for IE9: prevent page reload if query is the same */\n  if (isIE9 && isAllPropsSame) return;\n\n   return history.push(props);\n};\n\nexport const collectionPath = () => history\n  .location\n  .pathname\n  .replace(/^\\/|\\/$/g, '')\n  .toLowerCase();\n\nexport const isCollection = (collections) => collections && collections.includes(\n  collectionPath()\n);\n\nexport const isSearch = () =>\n  history.location.pathname === __root.config.getIn(['location', 'searchUrl']);\n\nexport const listenHistory = history.listen;\n\nexport const getQuery = () => {\n  const str = history.location.search;\n  const prefix = __root.config.getIn(['location', 'prefix']);\n  const elements = parse(str,\n    { decoder: (value) => decodeURIComponent(value.replace(/\\+/g, ' ')), ignoreQueryPrefix: true }\n  );\n  return Object.keys(elements).reduce((acc, key) => {\n    const _key = prefix ? key.replace(`${prefix}_`, '') : key;\n    return {\n      ...acc,\n      [_key]: ['limit', 'offset'].includes(_key)\n        ? Number(elements[key])\n        : elements[key]\n    }\n  }, {});\n};\n\nexport const buildQuery = (_query = {}) => {\n  const prefix = __root.config.getIn(['location', 'prefix']);\n  const query = Object.keys(_query).reduce((acc, key) =>\n    ({ ...acc, [`${!!prefix ? prefix + '_' : ''}${key}`]: _query[key] })\n  , {});\n  return stringify(query, {\n    encoder: encodeURIComponent,\n    addQueryPrefix: true,\n    sort: (a, b) => a.localeCompare(b)\n  })\n}\n\nexport const redirectToSearch = (q) => {\n  window.location.href =\n    __root.config.getIn(['location', 'searchUrl']) +\n    buildQuery({ q });\n};\n\nexport const setQuery = (query) => {\n  const search = buildQuery(query);\n\n  return pushHistory({ search });\n};\n\nexport const setPathname = (pathname) => pushHistory({ pathname });\n\nexport const getLocation = () => history.location;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar separateWords = function (string, options) {\n    if (options === void 0) { options = {}; }\n    var separator = options.separator || '_';\n    var split = options.split || /(?=[A-Z])/;\n    return string.split(split).join(separator);\n};\nexports.decamelize = function (string, options) { return separateWords(string, options).toLowerCase(); };\n//# sourceMappingURL=decamelize.js.map","export const hideFallback = (node) => {\n  const fallback = [].slice.call(node.querySelectorAll('.findify-fallback'));\n  for (let index = 0; index < fallback.length; index++) {\n    const element = fallback[index];\n    element.style.display = 'none';\n    element.style.visibility = 'hidden';\n  }\n}\n\nexport const showFallback = (node) => {\n  const fallback = [].slice.call(node.querySelectorAll('.findify-fallback'));\n  for (let index = 0; index < fallback.length; index++) {\n    const element = fallback[index];\n    element.style.display = '';\n    element.style.visibility = '';\n  }\n}\n\nexport const hideLoader = (node) => {\n  const loaders = [].slice.call(node.querySelectorAll('.findify-component-spinner'));\n  for (let index = 0; index < loaders.length; index++) {\n    const element = loaders[index];\n    element.style.display = 'none';\n    element.style.visibility = 'hidden';\n  }\n}\n","\"use strict\";\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"core-js/fn/array/includes\");\nvar analytics_1 = require(\"@findify/analytics\");\nvar events_1 = require(\"./bindings/events\");\nvar filters_1 = require(\"./bindings/filters\");\nvar dom_1 = require(\"./bindings/dom\");\nvar element_dataset_1 = require(\"element-dataset\");\nvar types_1 = require(\"@findify/analytics/lib/types\");\nelement_dataset_1.default();\nvar analyticsInstance;\nvar initialize = function (config) {\n    if (config === void 0) { config = { events: {} }; }\n    var eventsConfig = config && config.events || {};\n    analyticsInstance.state = __assign({}, analyticsInstance.state, { filters: filters_1.getFiltersOnPage(document) });\n    analyticsInstance.invalidate(events_1.getDeprecatedEvents(document));\n    analyticsInstance.invalidate(events_1.getEventsOnPage(document));\n    dom_1.startDOMListeners(analyticsInstance.sendEvent, document);\n    if (eventsConfig[types_1.EventName.viewPage] !== false &&\n        !analyticsInstance.state.events[types_1.EventName.viewPage]) {\n        analyticsInstance.sendEvent(types_1.EventName.viewPage, {});\n    }\n};\nvar analyticsDOM = function (props, context) {\n    if (context === void 0) { context = document; }\n    if (typeof props === 'function')\n        return analytics_1.default(props);\n    if (analyticsInstance)\n        return analyticsInstance;\n    analyticsInstance = analytics_1.default(props);\n    if (['complete', 'loaded', 'interactive'].includes(document.readyState) && document.body) {\n        initialize(props);\n    }\n    else {\n        document.addEventListener('DOMContentLoaded', function () { return initialize(props); }, false);\n    }\n    return analyticsInstance;\n};\nanalyticsDOM.prototype.__analytics = analytics_1.default;\nexports.default = analyticsDOM;\n//# sourceMappingURL=index.js.map","export const getParentNode = ({ config, node, type }) => {\n  const renderIn = config.get('renderIn');\n\n  if (\n    type === 'autocomplete' &&\n    window.innerWidth < config.get('mobileBreakpoint', 700) &&\n    config.get('mobileViewType') === 'sidebar'\n  ) return document.body;\n  if (renderIn === 'self' || !renderIn) return node;\n  if (renderIn === 'body') return document.body;\n  if (renderIn === 'parent') return node.parentElement;\n}\n","import { createChangeEmitter } from '@findify/change-emitter';\n\nexport default createChangeEmitter();\n","import { createElement } from \"react\";\nimport { Custom } from '@findify/react-components/src/';\n\nexport default (widget) => createElement(Custom, widget);\n","import { createElement } from 'react';\nimport { AutocompleteProvider } from \"@findify/react-connect\";\nimport { getQuery, setQuery } from '../../core/location';\nimport { Items } from '../../test.components';\nimport { registerHandlers } from './handlers';\nimport SignalCombinator from '../../helpers/SignalCombinator';\nimport { Autocomplete } from '@findify/react-components/src/';\nimport { Autocomplete as AutocompleteAgent } from \"@findify/agent\";\n\nconst empty = () => null\n\nconst createTrendingSearchesAgent = (config) => new AutocompleteAgent({\n  key: config.get('key'),\n  immutable: true,\n  user: __root.analytics.user\n})\n.defaults({ ...config.get('meta').toJS() })\n\nconst autocompleteComponent = createElement(Autocomplete);\nconst autocompleteTrendingComponent = createElement(Autocomplete, { isTrendingSearches: true });\n\nexport default (widget, rerender) => {\n  const { node, agent, config } = widget;\n  const state: any = getQuery();\n  const apiKey = config.get('key');\n  let trendingSearchesAgent;\n\n  if (state.q) node.value = state.q;\n\n  const combinator = new SignalCombinator(['closed', 'trending', 'open'], 'closed');\n  combinator.createSignal('trendingSearchesDisabled', empty, config.get('trendingSearchesDisabled', false));\n  combinator.createSignal('visible', empty, false);\n  combinator.createSignal('query', empty, '');\n  combinator.createSignal('suggestionCount', empty, 0);\n\n  const trending = combinator.createSignalSum(['query', 'suggestionCount'], (query, suggestionCount) => {\n    if (query === '' || suggestionCount === 0) return ['closed', 'trending'];\n    return ['closed', 'open'];\n  })\n\n  combinator.createSignalSum(\n    ['visible', 'trendingSearchesDisabled', trending],\n    (ui, noTs, { result }) => {\n      const isTrendingMode = result.includes('trending');\n      if ((isTrendingMode && noTs) || !ui) return ['closed'];\n      return ['open', 'trending'];\n    }\n  )\n\n  combinator.transitionTo('closed', () => rerender());\n  combinator.transitionTo('open', () => rerender('initial'));\n  combinator.transitionTo('trending', () => renderTrendingSearches());\n\n  const renderTrendingSearches = () => {\n    if (!trendingSearchesAgent) {\n      trendingSearchesAgent = createTrendingSearchesAgent(config)\n      trendingSearchesAgent.set('q', '')\n    }\n    rerender(\n      AutocompleteProvider,\n      { apiKey, config, agent: trendingSearchesAgent, isTrendingSearches: true },\n      autocompleteTrendingComponent\n    )\n  }\n\n  registerHandlers(widget, combinator);\n\n  agent.on('change:suggestions', (suggestions, meta) => {\n    combinator.signal('suggestionCount', suggestions.size)\n    combinator.signal('query', meta.get('q', ''))\n    combinator.transition();\n  })\n\n  const props = { apiKey, agent, config, key: 'normalAutocomplete' };\n  /** Render */\n  return createElement(AutocompleteProvider, props, autocompleteComponent);\n}\n","import axios from 'axios';\n\nexport default (platform, disabled) => {\n  if (!platform.shopify) return;\n  const user = __root.analytics.user;\n  if (!user.persist) {\n    const res = disabled\n      ? ''\n      : JSON.stringify({ uniq_id: user.uid, visit_id: user.sid });\n    axios.post('/cart/update.js', `attributes[_findify_id]=${res}`);\n  }\n}\n","import { Component, createElement } from 'react';\nimport { render, createPortal } from 'react-dom';\nimport { createFeature } from '../features/create';\nimport { getParentNode } from '../helpers/getParentNode';\nimport { debounce } from '../helpers/debounce';\nimport { Events } from './events';\n\nconst createRoot = () => {\n  const div = document.createElement('div');\n  div.id = 'findify-root';\n  div.style.display = 'none';\n  document.body.appendChild(div);\n  return div;\n}\n\nclass Portal extends Component<any>{\n  element: HTMLElement;\n  component: any;\n  parent: any;\n\n  static displayName = 'Container'\n  state = { component: null }\n\n  constructor(props) {\n    super(props);\n    const { widget } = props;\n    this.element = document.createElement('div');\n    this.element.className = `findify-container ${widget.config.get('cssSelector')}`;\n    this.parent = getParentNode(widget);\n    this.component = createFeature(widget)\n  }\n\n  componentDidMount() {\n    const { widget } = this.props;\n    if (widget.type === 'tabs') {\n      this.parent.insertBefore(this.element, this.parent.firstChild);\n    } else {\n      this.parent.appendChild(this.element);\n    }\n  }\n\n  componentWillUnmount() {\n    this.parent.removeChild(this.element);\n  }\n\n  render() {\n    return createPortal(this.component, this.element)\n  }\n}\n\nclass RootElement extends Component{\n  state = { widgets: [] }\n\n  static displayName = 'Findify'\n\n  constructor(props){\n    super(props);\n    this.state = { widgets: props.widgets.list() };\n    __root.listen((event, widget) => {\n      if (event === Events.attach) {\n        this.setState(({ widgets }: any) =>\n          ({ widgets: [...widgets, widget] })\n        )\n      }\n      if (event === Events.detach) {\n        this.setState(({ widgets }: any) =>\n          ({ widgets: widgets.filter(({ key }) => key !== widget.key) })\n        )\n      }\n    })\n  }\n\n  render() {\n    const { widgets } = this.state;\n    return widgets.map((widget: any) => \n      createElement(Portal, { widget, key: widget.key })\n    );\n  }\n}\n\nexport const renderWidgets = debounce((widgets) =>\n  render(createElement(RootElement, { widgets }), createRoot())\n);\n","\nimport 'core-js/fn/array/includes';\nimport * as Agents from '@findify/agent';\nimport { fromJS, isImmutable, Map } from 'immutable';\nimport { camelize } from '../helpers/capitalize';\nimport { isCollection } from './location';\nimport { Events } from './events';\n\nconst attrSelector = 'data-findify';\nconst keySelector = 'data-key';\n\nlet index: number = 0;\nlet cache: any[] = [];\nlet config: Map<any, any> = Map();\nconst noop = () => {};\nconst getType = type => ({\n  'search-button': 'autocomplete',\n  'recommendations': 'recommendation'\n}[type] || type);\n\nconst createAgent = (type, config) => {\n  const agent = Agents[camelize(type)];\n  if (!agent) return null;\n  const instance = new agent({\n    key: config.get('key'),\n    user: __root.analytics.user,\n    immutable: true,\n    ...(config.get('slot') && { slot: config.get('slot') } || {})\n  });\n\n  // Setup initial request\n  if (!config.get('disableAutoRequest')) {\n    instance.defaults(config.get('meta', Map()), true);\n  }\n\n  return instance;\n}\n\nconst createConfig = (type, node, key, customs = Map()) => {\n  const cfg = type === 'recommendation'\n    && config.getIn(['features', 'recommendations', '#' + node.getAttribute('id')])\n    || config.getIn(['features', type]);\n\n  return config.withMutations(c =>\n      c.mergeDeep(cfg)\n      .mergeDeep(customs)\n      .set('node', node)\n      .set('widgetKey', key)\n      .set('cssSelector', `findify-${type} findify-widget-${key}`)\n    );\n};\n\nconst getNodes = selector => [].slice.call(document.querySelectorAll(selector));\n\nconst getEntity = (selector, _type?, _config?) =>\n(\n  typeof selector === 'string'\n  ? getNodes(selector)\n  : [selector]\n)\n.map(node => {\n  let type = getType(_type || node.getAttribute(attrSelector));\n  const key = (_config && _config.get('widgetKey')) || node.getAttribute(keySelector) || ++index;\n\n  let config = createConfig(type, node, key, _config);\n\n  /** Change feature type to collection if we are on collection page */\n  if (type === 'search' && isCollection(config.get('collections'))) {\n    type = 'smart-collection';\n    config = config.set('type', type);\n  }\n\n  const agent = createAgent(type, config);\n\n  /** Actual widget */\n  const widget = { type, key, node, agent, config };\n\n  /** Notify everyone that widget was created */\n  __root.emit(Events.attach, widget);\n  return widget;\n})\n\nconst widgets = {\n  /** Add new widget */\n  attach(selector, type?, config?) {\n    const cfg = config && !isImmutable(config) ? fromJS(config) : config;\n    cache = [...cache, ...getEntity(selector, type, cfg)];\n    return cache;\n  },\n\n  /** Remove exist widget */\n  detach(key) {\n    const widgetToRemove = widgets.get(key);\n    cache = cache.filter(widget => key !== widget.key);\n    __root.emit(Events.detach, widgetToRemove);\n  },\n\n  /** Get all rendered widget */\n  list(){\n    return cache;\n  },\n\n  get(_key){\n    return cache.find(({ key }) => key === _key)\n  },\n\n  findByType(...types) {\n    return cache.filter(({ agent }) => agent && types.includes(agent.type));\n  }\n};\n\nexport const createWidgets = (_config) => {\n  config = _config;\n\n  // DY: Legacy\n  // TODO: Remove after they will release new version\n  (global as any).findifyCreateFeature = (selector, { type, ...config }) =>\n  widgets.attach(selector, type, config);\n\n  return widgets;\n}\n\nexport const bulkAddWidgets = (selectors = {}) => {\n  /** Attach default nodes */\n  widgets.attach(`[${attrSelector}]`);\n\n  /** Attach nodes specified in configuration */\n  for (const key in selectors) {\n    widgets.attach(key, selectors[key]);\n  }\n}\n","import { findDomNode } from 'react-dom';\nimport { List } from 'immutable'\nimport { addEventListeners } from '../../helpers/addEventListeners';\nimport { findClosestElement } from '../../helpers/findClosestElement';\nimport { isSearch, setQuery, buildQuery, redirectToSearch } from '../../core/location';\nimport { Events } from '../../core/events';\nimport { debounce } from '../../helpers/debounce';\n\nconst findClosestForm = findClosestElement('form');\n\nconst stylesUpdater = (ghost, styles: any) => {\n  let cache: any = {};\n  if (!ghost.childNodes.length) return;\n  for (const key in styles) {\n    if (cache[key] === styles[key]) return;\n    const type = typeof styles[key];\n    ghost.style[key] = type === 'string' ? styles[key] : styles[key] + 'px';\n  }\n  return cache = styles;\n}\n\nexport const registerHandlers = (widget, combinator) => {\n  const { node, config, agent } = widget;\n  const subscribers: any = [];\n  let container: any;\n  let findifyElementFocused = true;\n  if (node.getAttribute('autocomplete') !== 'off') node.setAttribute('autocomplete', 'off')\n\n  /** Track input position and update container styles */\n  const handleWindowScroll = debounce(() => {\n    container = container || document.querySelector(`.findify-widget-${widget.key}`);\n    if (!container.childNodes.length) return;\n\n    const { width, top, left, height } = node.getBoundingClientRect();\n    const _top = top + (window.scrollY || document.documentElement.scrollTop);\n    const _left = left + (window.scrollX || document.documentElement.scrollLeft);\n    if (top + height < 0 || left < 0) return;\n\n    return stylesUpdater(container, {\n      width,\n      height: 0,\n      top: _top + height,\n      left: _left,\n      position: 'absolute',\n      'will-change': 'top, left'\n    });\n  })\n\n  const resetReferencedAgentsLogging = debounce((value) => {\n    __root.widgets\n      .findByType('search', 'smart-collection', 'content')\n      .forEach(({ agent }) => agent.reset().defaults({ log: true }).set('q', value || ''));\n  }, 1000);\n\n  const updateReferencedAgents = (value, noLogs?) =>\n    __root.widgets\n      .findByType('search', 'smart-collection', 'content')\n      .forEach(({ agent }) => {\n        agent.reset();\n        if (noLogs) {\n          agent.defaults({ log: false });\n          resetReferencedAgentsLogging(value);\n        }\n        agent.set('q', value || '')\n      });\n\n  /** Handle input change */\n  const handleInputChange = (e) => {\n    const value = e.target.value || '';\n    if (config.get('renderIn') === 'body') handleWindowScroll();\n    if (config.get('instant') && isSearch()) {\n      \n      return updateReferencedAgents(value, true);\n    }\n    agent.set('q', value);\n    combinator.signal('visible', true);\n    combinator.signal('query', value);\n    combinator.transition()\n  };\n\n  const insideAutocomplete = (node: HTMLElement) => {\n    if (!node || !node.parentElement) return false;\n    if (node.hasAttribute && node.hasAttribute('data-findify-autocomplete')) return true;\n    return insideAutocomplete(node.parentElement);\n  }\n\n  const isAutocompleteRelated = (e) => (\n    e.relatedTarget && insideAutocomplete(e.relatedTarget)\n  )\n\n  /** Handle input blur */\n  const handleInputBlur = (e) =>\n    (!findifyElementFocused && !isAutocompleteRelated(e)) &&\n    e.target === node &&\n    __root.emit(Events.autocompleteFocusLost, widget.key)\n\n  const handleKeydown = ({ key, target }) => {\n    return key === 'Enter' && search(target.value)\n  }\n\n  /** search for the value */\n  const search = (_value?) => {\n    const value = _value || agent.state.get('q') || '';\n    if (!isSearch()) return redirectToSearch(value);\n\n    updateReferencedAgents(value);\n\n    __root.widgets\n      .findByType('autocomplete')\n      .forEach(({ node }) => node.value = value);\n    combinator.signal('visible', false);\n    combinator.transition();\n  };\n\n  const handleFormSubmit = e => {\n    if (e) e.preventDefault();\n    search(node.value);\n  }\n\n  /** Listen for input change */\n  subscribers.push(addEventListeners(\n    ['input', 'cut', 'paste'],\n    handleInputChange,\n    node\n  ));\n\n  subscribers.push(addEventListeners(\n    ['focus'],\n    (e) => {\n      if (config.get('instant') && isSearch()) return;\n      findifyElementFocused = true;\n      if (!agent.state.get('q')) {\n        agent.set('q', e.target.value);\n        combinator.signal('query', e.target.value);\n      }\n      combinator.signal('visible', true);\n      combinator.transition();\n    },\n    node\n  ));\n\n  /** Listen for input blur */\n  subscribers.push(addEventListeners(\n    ['focusout'],\n    handleInputBlur,\n    document.body\n  ));\n\n  subscribers.push(addEventListeners(\n    ['keydown'],\n    handleKeydown,\n    node,\n    false\n  ))\n\n  /** Listen for form submit */\n  if (!config.get('disableFormSubmit')) {\n    const form = findClosestForm(node);\n    if (form) {\n      subscribers.push(addEventListeners(\n        ['submit'],\n        handleFormSubmit,\n        form\n      ))\n    }\n  }\n\n  /** Update container position  */\n  if (config.get('renderIn') === 'body') {\n    subscribers.push(addEventListeners(\n      [\n        'mousemove',\n        'webkitTransitionEnd',\n        'otransitionend',\n        'oTransitionEnd',\n        'msTransitionEnd',\n        'transitionend',\n        'animationiteration',\n        'webkitAnimationIteration',\n        'oanimationiteration',\n        'MSAnimationIteration'\n      ],\n      handleWindowScroll,\n      document\n    ));\n    subscribers.push(addEventListeners(\n      ['scroll'],\n      debounce(handleWindowScroll),\n      window\n    ))\n  }\n\n  const getEventPath = (evt) => {\n    if (evt.path) return evt.path; // Chrome only, for now\n    // (Semi)-Polyfill for other browsers, like Edge & IE\n    // Semi, because originally path keeps the original DOM before mutations,\n    // that could've occured after event was dispatched but before it was received\n    // Recursion might be more beatiful, but in that case we will need more speed\n    const path: any[] = [];\n    let currentElement = evt.target;\n    while (currentElement) {\n      path.push(currentElement);\n      currentElement = currentElement.tagName !== 'HTML' ? currentElement.parentElement : null;\n    }\n    path.push(document);\n    path.push(window);\n    return path;\n\n  }\n\n  const handleActiveElementChange = (evt) => {\n    findifyElementFocused = !!((getEventPath(evt)).find(item => item.hasAttribute && item.hasAttribute('data-findify-autocomplete')))\n  }\n\n  subscribers.push(addEventListeners(\n    ['mousemove', 'touchmove'],\n    debounce(handleActiveElementChange),\n    document\n  ))\n\n  /** Unsubscribe from events on instance destroy  */\n  const unsubscribe = __root.listen((event, prop, ...args) => {\n    if (event === Events.search && prop === widget.key) return search(...args);\n    if (event === Events.autocompleteFocusLost && prop === widget.key) {\n      combinator.signal('visible', false);\n      combinator.transition();\n    }\n    if (event !== Events.detach || prop !== widget) return;\n    subscribers.forEach(fn => fn());\n    unsubscribe();\n  })\n\n  window.requestAnimationFrame(() => {\n    combinator.signal('visible', false)\n    combinator.transition();\n  })\n  return;\n}\n","import 'core-js/es6/promise';\n\nexport const documentReady = new Promise((resolve) => {\n  if (\n    ['complete', 'loaded', 'interactive'].includes(document.readyState) &&\n    document.body\n  ) {\n    resolve();\n  } else {\n    document.addEventListener('DOMContentLoaded', resolve, false);\n  }\n})\n","/**\n * Find closest element by child\n * @param selector Parent selector\n */\nexport const findClosestElement = selector => el => {\n  let matchesFn;\n  let parent;\n\n  [\n    'matches',\n    'webkitMatchesSelector',\n    'mozMatchesSelector',\n    'msMatchesSelector',\n    'oMatchesSelector',\n  ].some(fn => {\n    if (typeof document.body[fn] === 'function') {\n      matchesFn = fn;\n      return true;\n    }\n    return false;\n  });\n\n  while (el) {\n    parent = el.parentElement;\n    if (parent && parent[matchesFn](selector)) {\n      return parent;\n    }\n    el = parent;\n  }\n\n  return null;\n};\n","import { createElement } from 'react';\nimport { RecommendationProvider } from \"@findify/react-connect\";\nimport { getQuery, setQuery } from '../../core/location';\nimport { hideFallback, hideLoader } from '../../helpers/fallbackNode';\nimport { getPayload } from './payload';\nimport { Recommendation } from '@findify/react-components/src/';\n\nexport default (widget) => {\n  const { node, agent, config } = widget;\n  const props = { agent, config, apiKey: config.get('key') };\n\n  if (!config.get('disableAutoRequest')) {\n    agent.defaults(getPayload(config, __root.analytics.state));\n  }\n\n  /** Remove entity and instance if nothing was found */\n  agent.on('change:items', items => {\n    if (items.isEmpty()) return __root.widgets.detach(widget.key);\n    hideFallback(node);\n    hideLoader(node);\n  })\n\n  /** Render */\n  return createElement(RecommendationProvider, props, createElement(Recommendation));\n}\n","import { createElement } from 'react';\nimport { ContentProvider } from \"@findify/react-connect\";\nimport { Recommendation as RecommendationAgent } from \"@findify/agent\";\nimport { getQuery, setQuery, isSearch, listenHistory } from '../../core/location';\nimport { hideFallback, hideLoader } from '../../helpers/fallbackNode';\nimport { Events } from '../../core/events';\nimport { scrollTo } from '../../helpers/scrollTo';\nimport { Content } from '@findify/react-components/src/';\n\nexport default (widget, render) => {\n  const { agent, config, node } = widget;\n  const apiKey = config.get('key');\n  const { q } = getQuery();\n  const { type } = node.dataset;\n  const props = { agent, apiKey, config };\n\n  agent.defaults({ type: [type] });\n  agent.set('q', q);\n\n  /** Listen to changes */\n  agent.on('change:query', (q, meta) => {\n    setQuery(q.toJS())\n    render('initial');\n  });\n\n  /** Listen to location back/fwd */\n  const stopListenLocation = listenHistory((_, action) => {\n    if (action !== 'POP') return;\n    const { q } = getQuery();\n    agent.applyState({ q });\n    render('initial');\n  });\n\n  /** Switch to recommendation if query not present */\n  agent.on('change:items', (items) => {\n    if (!items.isEmpty()) {\n      hideFallback(node);\n      hideLoader(node);\n      if (!config.getIn(['view', 'infinite']) && config.get('scrollTop') !== false) {\n        scrollTo(config.get('cssSelector'), config.get('scrollTop'))\n      }\n      return render('initial');\n    }\n  })\n\n  /** Unsubscribe from events on instance destroy  */\n  const unsubscribe = __root.listen((event, prop, ...args) => {\n    if (event !== Events.detach || prop !== widget) return;\n    stopListenLocation();\n    unsubscribe();\n  })\n\n  /** Render */\n\n  return createElement(ContentProvider, props, createElement(Content))\n}\n","import { createElement } from 'react';\nimport { SearchProvider, RecommendationProvider, ContentProvider } from \"@findify/react-connect\";\nimport { Recommendation as RecommendationAgent } from \"@findify/agent\";\nimport { getQuery, setQuery, isSearch, listenHistory } from '../../core/location';\nimport { hideFallback, showFallback, hideLoader } from '../../helpers/fallbackNode';\nimport { Events } from '../../core/events';\nimport { scrollTo } from '../../helpers/scrollTo';\nimport { Search, ZeroResults } from '@findify/react-components/src/';\n\nconst createFallbackAgent = (config, node) => new RecommendationAgent({\n  key: config.get('key'),\n  immutable: true,\n  user: __root.analytics.user\n})\n.defaults({ ...config.get('meta').toJS(), type: config.get('zeroResultsType') })\n.on('change:items', () => {\n  hideFallback(node);\n  hideLoader(node);\n});\n\nexport default (widget, render) => {\n  const { agent, config, node } = widget;\n  const state = getQuery();\n  const apiKey = config.get('key');\n  const props = { agent, apiKey, config };\n  let fallbackAgent;\n\n  const renderZeroResults = () => {\n    if (!fallbackAgent) fallbackAgent = createFallbackAgent(config, node);\n    return render(\n      RecommendationProvider,\n      { agent: fallbackAgent, apiKey, config },\n      createElement(ZeroResults, getQuery())\n    )\n  }\n\n  if (!isSearch()) {\n    showFallback(node);\n    hideLoader(node);\n    __root.emit(Events.collectionNotFound, widget);\n    return null;\n  }\n\n  /** Setup initial request */\n  if (!config.get('disableAutoRequest')) {\n    agent.applyState(state);\n  }\n\n  /** Listen to changes */\n  agent.on('change:query', (q, meta) => {\n    setQuery(q.toJS())\n    if (!meta.get('total')) return renderZeroResults();\n    render('initial');\n  });\n\n  agent.on('change:redirect', async (redirect, meta) => {\n    render();\n    await __root.analytics.sendEvent('redirect', {\n      ...redirect.toJS(),\n      rid: meta.get('rid'),\n      suggestion: meta.get('q')\n    });\n    document.location.href = redirect.get('url');\n  });\n\n  /** Listen to location back/fwd */\n  const stopListenLocation = listenHistory((_, action) => {\n    if (action !== 'POP') return;\n    agent.applyState(getQuery());\n    render('initial');\n  });\n\n  /** Switch to recommendation if query not present */\n  agent.on('change:items', (items) => {\n    if (!items.isEmpty()) {\n      hideFallback(node);\n      hideLoader(node);\n      if (!config.getIn(['view', 'infinite']) && config.get('scrollTop') !== false) {\n        scrollTo(config.get('cssSelector'), config.get('scrollTop'))\n      }\n      return render('initial');\n    }\n    hideLoader(node);\n    return renderZeroResults();\n  })\n\n  /** Unsubscribe from events on instance destroy  */\n  const unsubscribe = __root.listen((event, prop, ...args) => {\n    if (event !== Events.detach || prop !== widget) return;\n    stopListenLocation();\n    unsubscribe();\n  })\n\n  /** Render */\n\n  return createElement(SearchProvider, props, createElement(Search))\n}\n","import { TabsLayout } from '@findify/react-components/src/';\nimport { Events } from '../../core/events';\n\nconst getNestedWidgets = root => {\n  const children = Array.from(root.children);\n  return __root.widgets.list()\n    .filter(({ node }) => node.parentNode === root)\n    .sort((prev, next) => children.indexOf(prev.node) - children.indexOf(next.node));\n}\n\nconst getProps = (widgets, state, updateCount) => ({\n  onClick: updateCount,\n  widgets: widgets.map(({ node, key }, index) => ({\n    key,\n    active: state.active === key,\n    title: node.dataset.title,\n    count: state.counter[index]\n  }))\n});\n\nconst createState = (_widgets, render) => {\n  const widgets = [..._widgets];\n  const state = {\n    counter: {},\n    active: widgets[0] && widgets[0].key\n  }\n\n  const hydrate = () => {\n    widgets.forEach(widget => {\n      widget.active = widget.key === state.active;\n      widget.node.style.display = widget.key ===  state.active ? 'block' : 'none';\n    });\n    render(TabsLayout, getProps(widgets, state, toggle))\n  }\n\n  const toggle = (key) => {\n    state.active = key;\n    __root.emit(Events.hydrate, key);\n    hydrate()\n  };\n\n  const updateCount = (index, count) => {\n    state.counter[index] = count;\n    hydrate();\n  };\n\n  const getState = () => state;\n\n  return { updateCount, toggle, getState }\n}\n\n\nexport default (widget, render) => {\n  const { node } = widget;\n  const widgets = getNestedWidgets(node);\n  const { updateCount, getState } = createState(widgets, render);\n  \n\n  widgets.forEach(({ type, agent }, index) => agent.on('change:meta', (meta) => {\n    updateCount(index, type === 'recommendation' ? meta.get('limit') : meta.get('total'));\n  }));\n\n  const unsubscribe = __root.listen((event, prop) => {\n    if (event !== Events.detach || prop !== widget) return;\n    unsubscribe();\n    render();\n  });\n\n  return null;\n}\n","import { createElement } from 'react';\nimport { SmartCollectionProvider } from \"@findify/react-connect\";\nimport { getQuery, setQuery, collectionPath, listenHistory } from '../../core/location';\nimport { Events } from '../../core/events';\nimport emitter from '../../core/emitter';\nimport { Items } from '../../test.components';\nimport { scrollTo } from '../../helpers/scrollTo';\nimport { hideFallback, showFallback, hideLoader } from '../../helpers/fallbackNode';\nimport { Search, ZeroResults } from '@findify/react-components/src/';\n\nexport default (widget, render) => {\n  const { agent, config, node } = widget;\n  const apiKey = config.get('key');\n  const props = { agent, apiKey, config };\n  const state = getQuery();\n\n  /** Listen to location back/fwd */\n  const stopListenLocation = listenHistory((_, action) => {\n    if (action !== 'POP') return;\n    agent.applyState(getQuery());\n    render('initial');\n  });\n\n  /** Switch to recommendation if query not present */\n  agent.on('change:items', (items) => {\n    if (!items.isEmpty()) {\n      hideFallback(node);\n      hideLoader(node);\n      if (!config.getIn(['view', 'infinite']) && config.get('scrollTop') !== false) {\n        scrollTo(config.get('cssSelector'), config.get('scrollTop'))\n      }\n      render('initial');\n    } else {\n      showFallback(node);\n      hideLoader(node);\n      __root.emit(Events.collectionNotFound, widget);\n      render();\n    }\n  })\n\n  agent.on('change:redirect', async (redirect, meta) => {\n    await __root.analytics.sendEvent('redirect', {\n      ...redirect.toJS(),\n      rid: meta.get('rid'),\n      suggestion: meta.get('q')\n    });\n    document.location.href = redirect.get('url');\n  });\n\n  agent.on('error', () => {\n    showFallback(node);\n    hideLoader(node);\n    render();\n  })\n\n  /** Setup initial request */\n  if (!config.get('disableAutoRequest')) {\n    agent.defaults({\n      slot: collectionPath(),\n      rules: config.get('includeRulesInCollection') ? __root.analytics.state.filters : void 0\n    });\n    agent.applyState(state);\n  }\n\n  /** Listen to changes */\n  agent.on('change:query', q => setQuery(q.toJS()));\n\n  /** Switch to recommendation if query not present */\n  // agent.on('change:items', handleFirstResponse);\n\n  /** Unsubscribe from events on instance destroy  */\n  const unsubscribe = __root.listen((event, prop, ...args) => {\n    if (event !== Events.detach || prop !== widget) return;\n    stopListenLocation();\n    unsubscribe();\n  });\n\n  /** Render */\n  return createElement(SmartCollectionProvider, props, createElement(Search, { isCollection: true }));\n}\n","import get from 'lodash/get';\n\nconst getIdsFromEvents = events => ({\n  item_id: get(events, ['view-page', 'item_id']),\n  item_ids: get(events, ['update-cart', 'line_items'], []).map(\n    i => i.item_id || i.product_id\n  ),\n});\n\nexport const getPayload = (config, { events, filters }) => {\n  const { item_id, item_ids } = getIdsFromEvents(events)\n  const type = config.get('type');\n  const slot = config.get('slot');\n  const multipleIds = config.get('multipleIds');\n\n  const payload: any = { slot, type };\n\n  if (filters && !!filters.length) {\n    payload.rules = filters;\n  }\n\n  if (['bought', 'viewed'].includes(type)) {\n    payload.item_ids = [item_id];\n  }\n\n  if (type === 'purchasedTogether') {\n    payload.item_ids = multipleIds ? item_ids : [item_id];\n  }\n\n  return payload;\n};\n","var map = {\n\t\"./autocomplete\": \"c3pS\",\n\t\"./autocomplete/\": \"c3pS\",\n\t\"./autocomplete/handlers\": \"k8c5\",\n\t\"./autocomplete/handlers.ts\": \"k8c5\",\n\t\"./autocomplete/index\": \"c3pS\",\n\t\"./autocomplete/index.ts\": \"c3pS\",\n\t\"./content\": \"sQLV\",\n\t\"./content/\": \"sQLV\",\n\t\"./content/index\": \"sQLV\",\n\t\"./content/index.ts\": \"sQLV\",\n\t\"./create\": \"FgcQ\",\n\t\"./create.ts\": \"FgcQ\",\n\t\"./custom\": \"Y70t\",\n\t\"./custom/\": \"Y70t\",\n\t\"./custom/index\": \"Y70t\",\n\t\"./custom/index.ts\": \"Y70t\",\n\t\"./recommendation\": \"s5RT\",\n\t\"./recommendation/\": \"s5RT\",\n\t\"./recommendation/index\": \"s5RT\",\n\t\"./recommendation/index.ts\": \"s5RT\",\n\t\"./recommendation/payload\": \"v7cu\",\n\t\"./recommendation/payload.ts\": \"v7cu\",\n\t\"./search\": \"saiO\",\n\t\"./search/\": \"saiO\",\n\t\"./search/index\": \"saiO\",\n\t\"./search/index.ts\": \"saiO\",\n\t\"./smart-collection\": \"tZwI\",\n\t\"./smart-collection/\": \"tZwI\",\n\t\"./smart-collection/index\": \"tZwI\",\n\t\"./smart-collection/index.ts\": \"tZwI\",\n\t\"./tabs\": \"sor5\",\n\t\"./tabs/\": \"sor5\",\n\t\"./tabs/index\": \"sor5\",\n\t\"./tabs/index.ts\": \"sor5\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"vRk2\";","\"use strict\";\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\n            t[p[i]] = s[p[i]];\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar events_1 = require(\"./events\");\nfunction matches(el, selector) {\n    var proto = Element.prototype;\n    var fn = proto.matches\n        || proto.webkitMatchesSelector\n        || proto.mozMatchesSelector\n        || proto.msMatchesSelector;\n    return fn.call(el, selector);\n}\nexports.startDOMListeners = function (sendEvent, root) {\n    return root.addEventListener('click', function (e) {\n        if (!matches(e.target, '[data-findify-track]'))\n            return;\n        var _a = events_1.getEventData(e.target), track = _a.track, props = __rest(_a, [\"track\"]);\n        sendEvent(track, props);\n    }, false);\n};\n//# sourceMappingURL=dom.js.map","declare module window {\n  const findifyCallback: Promise<any> | undefined | any\n}\n\nexport default root => new Promise(resolve => {\n  const callbacks = window.findifyCallbacks = window.findifyCallbacks || [];\n  window.findifyCallbacks.push = (cb) => cb(root);\n  if (!callbacks) return resolve();\n  const promises = [];\n  for (let index = 0; index < callbacks.length; index++) {\n    const callback = callbacks[index];\n    if (callback instanceof Promise) {\n      promises.push(callback(root));\n    } else {\n      callback(root);\n    }\n  }\n  return Promise.all(promises).then(resolve);\n});\n","export const debounce: any = (fn, wait?) => {\n\tlet timeout;\n\treturn function () {\n    const ctx = this;\n    const args = arguments;\n\t\tclearTimeout(timeout);\n\t\ttimeout = setTimeout(() => fn.apply(ctx, args), wait || 0);\n\t};\n};\n"],"sourceRoot":""}